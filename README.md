# NewsListPhp

## Создание класса веб-приложения:

### Упражнение 1: Создание класса
* В текстовом редакторе откройте файл news\INewsDB.class.php
* Внимательно ознакомьтесь с его содержимым
* В текстовом редакторе откройте файл news\NewsDB.class.php
* Создайте и опишите класс NewsDB реализующий интерфейс INewsDB
* Создайте константу класса DB_NAME и присвойте ей значение
news.db - имя базы данных. Файл должен создаваться в корневой
директории сайта!
* Создайте закрытое (private) свойство $_db для хранения экземпляра
класса SQLite3.
* Подумайте, что если данный класс будет наследоваться? Надо
обеспечить доступ на чтение значения свойства $_db классамнаследникам
Упражнение 2: Создание конструктора и деструктора класса
* Создайте и опишите конструктор класса, в котором выполняется
подключение к базе данных SQLite
* Присвойте свойству $_db значение, которое является экземпляром
класса SQLite3
* Создайте и опишите деструктор класса, в котором выполняется
удаление экземпляра класса SQLite3
Упражнение 3: Проверка работы скрипта
* В глобальной области кода (вне класса) создайте временный объект
$news, экземпляр класса NewsDB
* Сохраните файл news\NewsDB.class.php
* Запустите браузер
* Наберите в адресной строке браузера
http://mysite.local/news/NewsDB.class.php
Откройте проводник Windows и перейдите в корневую директорию

### Лабораторная работа 2.1

* Откройте проводник Windows и перейдите в корневую директорию
сайта mysite.local
( C:\Пользователи\Общие\OpenServer\domains\mysite.local\ )
* В директории вы должны увидеть созданный пустой файл news.db
* Если файла нет или код выдает ошибки, найдите их и исправьте
* Удалите файл news.db

Создание и заполнение базы данных веб-приложения
### Упражнение 1: Изменение конструктора класса
* В текстовом редакторе откройте файл news\news.txt
* Ознакомьтесь со структурой базы данных news
* В текстовом редакторе откройте файл news\NewsDB.class.php

* Если базы данных не существует, создайте ее и выполните SQL
запросы для добавления таблиц. Готовые запросы находятся в
файле news\news.txt
* В противном случае, просто откройте существующую базу данных
для работы
Измените конструктор класса так, чтобы в нём выполнялась проверка,
существует ли база данных на следующих условиях:
* Сохраните файл news\NewsDB.class.php
### Упражнение 2: Проверка работы скрипта
* Запустите браузер
* Наберите в адресной строке браузера
http://mysite.local/news/NewsDB.class.php
* В корневой директории вы должны увидеть созданный заполненный
файл news.db
* Если файла нет или он есть, но пустой, или код выдает ошибки,
найдите их и исправьте
* В файле news\NewsDB.class.php удалите строку создающую объект
$news и сохраните данный файл

### Лабораторная работа 2.2

Добавление записей в базу данных
Упражнение 1: Настройка главного файла
* В текстовом редакторе откройте файл news\news.php
* В начале файла подключите файл с описанием класса NewsDB
* Создайте объект $news, экземпляр класса NewsDB
* Создайте переменную $errMsg со строковым значением "" (пустая
строка)
* Ниже по коду после строки <h1>Последние новости</h1> проверьте,
не является ли переменная $errMsg пустой строкой? Если НЕТ, то
выведите значение переменной $errMsg в произвольной форме
* В верхней части файла (после объявления переменной $errMsg)
проверьте, была ли отправлена HTML-форма? Если ДА, то подключите
файл с кодом для обработки HTML-формы save_news.inc.php
* Сохраните файл news\news.php

### Упражнение 2: Описание метода добавления записи в базу данных

* В текстовом редакторе откройте файл news\NewsDB.class.php
* Опишите метод saveNews(). Описание параметров и возвращаемого
значеня метода можно посмотреть в интерфейсе INewsDB
* Создайте переменную $dt и присвойте ей значение текущих даты и
времени в формате временной метки (timestamp)
* Сформируйте строку запроса на добавление новой записи в таблицу
msgs, используя переменную $dt и переданные параметры
* Выполните запрос
* Возвратите нужное значение
* Сохраните файл news\NewsDB.class.php
Упражнение 3: Обработка параметров HTML-формы
* В текстовом редакторе откройте файл news\save_news.inc.php
Проверьте, была ли корректным образом отправлена HTML-форма?

### Лабораторная работа 2.3

* Если НЕТ, то присвойте переменной $errMsg строковое значение
"Заполните все поля формы!"
* Если ДА, то отфильтруйте полученные данные и вызовите метод
saveNews(), передав ему необходимые параметры
Проверьте, была ли корректным образом отправлена HTML-форма?

* Если ДА, выполните перезапрос страницы news.php
* Если НЕТ, то присвойте переменной $errMsg строковое значение
"Произошла ошибка при добавлении новости"
С помощью возвращаемого методом значения проверьте, был ли
запрос успешным?
* Сохраните файл news\save_news.inc.php
Упражнение 4: Проверка работы скрипта
* Запустите браузер
* Наберите в адресной строке браузера
http://mysite.local/news/news.php
* Добавьте новость заполнив поля HTML-формы
* Откройте файл базы данных news.db в тестовом редакторе и
убедитесь, что запись добавлена
* Добавьте еще несколько новостей
* Попробуйте послать форму, оставив некоторые поля пустыми
* Если есть ошибки, найдите их и исправьте
Выборка записей из базы данных и их показ
###  Упражнение 1: Описание метода выборки записей из базы
данных
• В текстовом редакторе откройте файл news\NewsDB.class.php
• Опишите метод getNews(). Описание параметров и возвращаемого
значеня метода можно посмотреть в интерфейсе INewsDB
• Сформируйте строку SQL-запроса на выборку всех данных из таблицы
msgs в обратном порядке. Обратите внимание, что в запросе
необходимо сделать объединение двух таблиц. Запрос должен
выглядеть примерно так:
SELECT msgs.id as id, title, category.name as category,
description, source, datetime
FROM msgs, category
WHERE category.id = msgs.category
ORDER BY msgs.id DESC
• Выполните запрос
• Возвратите нужное значение
• Сохраните файл news\NewsDB.class.php
Упражнение 2: Подключение файла обработки данных
• В текстовом редакторе откройте файл news\news.php
• Внизу файла перед закрывающим тэгом подключите файл news
\get_news.inc.php с кодом для обработки полученных записей
• Сохраните файл news\news.php
Упражнение 3: Вывод записей
• В текстовом редакторе откройте файл news\get_news.inc.php
• Вызовите метод getNews()
•
○ Если НЕТ, то присвойте переменной $errMsg строковое значение
"Произошла ошибка при выводе новостной ленты"
С помощью возвращаемого методом значения проверьте, был ли
запрос успешным?
Лабораторная работа 2.4

"Произошла ошибка при выводе новостной ленты"
○ Если ДА, то получите количество записей и выведите его в
браузер в произвольной форме
• Используя цикл, выведите в браузер все новости со ссылкой на
конкретную новость в произвольной форме
• После каждого сообщения сформируйте ссылку для удаления этой
записи. Информацию об идентификаторе удаляемого сообщения
передавайте методом GET
• Сохраните файл news\get_news.inc.php
Упражнение 4: Проверка работы скрипта
• Запустите браузер
• Наберите в адресной строке браузера
http://mysite.local/news/news.php
• Убедитесь, что данные выводятся корректно. Если есть ошибки,
найдите их и исправьте

Удаление записей из базы данных
###  Упражнение 1: Описание метода удаления записи из базы данных
• В текстовом редакторе откройте файл news\NewsDB.class.php
• Опишите метод deleteNews(). Описание параметров и возвращаемого
значеня метода можно посмотреть в интерфейсе INewsDB
• Сформируйте строку SQL-запроса на удаление записи
• Выполните запрос и возвратите нужное значение
• Сохраните файл news\NewsDB.class.php
Упражнение 2: Подключение файла обработки данных для
удаления
• В текстовом редакторе откройте файл news\news.php
• Вверху файла перед началом HTML-кода подключите файл news
\delete_news.inc.php с кодом для обработки данных для удаления
записи
• Перед подключением убедитесь в наличие параметра, который
указывает на удаление записи
• Сохраните файл news\news.php
Упражнение 3: Удаление записи
• В текстовом редакторе откройте файл news\delete_news.inc.php
• Примите и отфильтруйте полученные данные
•
○ Если НЕТ, то просто выполните перезапрос страницы
○ Если ДА, то вызовите метод deleteNews()
Проверьте, корректны ли полученные данные?
•
○ Если НЕТ, то присвойте переменной $errMsg строковое значение
"Произошла ошибка при удалении новости"
Если ДА, то выполните перезапрос страницы, чтобы избавиться
С помощью возвращаемого методом значения проверьте, был ли
запрос успешным?
### Лабораторная работа 2.5

○ Если ДА, то выполните перезапрос страницы, чтобы избавиться
от информации, переданной через адресную строку
• Сохраните файл news\delete_news.inc.php
Упражнение 4: Проверка работы скрипта
• Запустите браузер
• Наберите в адресной строке браузера
http://mysite.local/news/news.php
• Попробуйте удалить одну или несколько записей
• Убедитесь, что записи удаляются корректно
• Попробуйте удалить несуществующую запись
• Попробуйте передать GET-параметром произвольную строку
• Убедитесь, что показывается информация об ошибках
• Если есть ошибки, найдите их и исправьте

